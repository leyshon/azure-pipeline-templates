parameters:
  terraformRoot: '' 
  backendConfigFile: ''
  variablesFile: ''
  extraArgs: ''
steps:  
- task: PowerShell@2
  inputs:
    TargetType: 'inline'
    Script: |
      Set-PSDebug -Trace 1
      Set-Location ${{ parameters.terraformRoot }}
      Push-Location
      Pop-Location
      pwd
      Get-ChildItem
      terraform init -backend-config=${{ parameters.backendConfigFile }}
      terraform apply -auto-approve -input=false -var-file=${{ parameters.variablesFile }} ${{ parameters.extraArgs }}
    pwsh: true